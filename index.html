<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
  <title>Court File Tracker</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Top Header -->
  <header class="topbar">
    <button id="menuBtn" onclick="toggleSidebar()">‚ò∞</button>
    <div class="top-title">
      <h1>Court File Tracker</h1>
      <p>Smart Solutions for Efficient Record Management</p>
    </div>
    <div class="window-controls" style="display: none;">
      <button id="minimizeBtn" class="window-btn minimize-btn" title="Minimize">‚àí</button>
      <button id="resizeBtn" class="window-btn resize-btn" title="Maximize/Restore">‚ñ°</button>
      <button id="closeBtn" class="window-btn close-btn" title="Close">‚úï</button>
    </div>
  </header>

  <!-- Main App Container -->
  <div class="app-container">
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
      <img src="icon-192.png" alt="CFT Logo" class="sidebar-logo" />
      <button onclick="navigate('dashboard')"><span>üè†</span> Dashboard</button>
      <button onclick="navigate('newFile')"><span>üìÇ</span> New Entry</button>
      <button onclick="navigate('return')"><span>‚Ü©Ô∏è</span> Return File</button>
      <button onclick="navigate('fileFetcher')"><span>üë§</span> File Fetcher</button>
      <button onclick="navigate('admin')"><span>üõ°Ô∏è</span> Admin</button>
      <button onclick="navigate('developersDisclaimer')"><span>‚ÑπÔ∏è</span> Developers Disclaimer</button>
      <button id="installBtn" style="display: none;"><span>üì±</span> Install App</button>
    </aside>
    <!-- Main Screens -->
    <main>
      <!-- Dashboard -->
      <section id="dashboard" class="screen">
        <h2>Dashboard Summary</h2>
        <div id="dashboardStats" style="margin-bottom: 20px;">
          <canvas id="statsChart" height="100"></canvas>
        </div>
        <div id="dashboardCards" class="dashboard-grid">
          <!-- Cards will be populated here -->
        </div>
        <div id="dashboardReportPanel" style="display:none; margin-top: 20px;">
          <!-- Report panel content -->
        </div>
      </section>
      <!-- New Entry -->
      <section id="newFile" class="screen">
        <h2>New File Entry</h2>
        <form id="newFileForm" enctype="multipart/form-data">
          <input type="text" id="fileNumber" placeholder="File Number" required />
          <input type="text" id="partyName" placeholder="Party Name" required />
          <input type="date" id="filingDate" required />
          <input type="text" id="courtName" placeholder="Court Name" required />
          <input type="text" id="caseType" placeholder="Case Type" required />
          <input type="file" id="filePhoto" accept="image/*" capture="environment" />
          <button type="submit">Submit</button>
        </form>
        <div id="photoPreview" class="photo-preview"></div>
      </section>
      <!-- Return File -->
      <section id="return" class="screen">
        <h2>Return File</h2>
        <form id="returnFileForm">
          <input type="text" id="returnFileNumber" placeholder="File Number" required />
          <input type="text" id="returnTakerName" placeholder="Taker Name" required />
          <input type="date" id="returnDate" required />
          <button type="submit">Return File</button>
        </form>
      </section>
      <!-- File Fetcher -->
      <section id="fileFetcher" class="screen">
        <h2>File Fetcher</h2>
        <input type="text" id="searchInput" placeholder="Search by File Number or Party Name" />
        <div id="searchResults" class="search-results"></div>
      </section>
      <!-- Admin -->
      <section id="admin" class="screen">
        <h2>Admin Panel</h2>
        <button onclick="backupData()">Backup Data</button>
        <button onclick="restoreData()">Restore Data</button>
        <button onclick="showUserManagement()">Manage Users</button>
        <div id="userManagement" style="display:none;">
          <!-- User management content -->
        </div>
      </section>
      <!-- Developers Disclaimer -->
      <section id="developersDisclaimer" class="screen">
        <h2>Developers Disclaimer</h2>
        <p>This application is developed for demonstration purposes only.</p>
      </section>
    </main>
  </div>

  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
  <script src="app.js"></script>
  <script>
    // Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function () {
        navigator.serviceWorker.register('service-worker.js')
          .then(() => console.log("Service Worker registered"))
          .catch((err) => console.error("Service Worker registration failed:", err));
      });
    }

    // Handle Install Prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'block';
    });

    document.getElementById('installBtn').addEventListener('click', () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the install prompt');
          }
          document.getElementById('installBtn').style.display = 'none';
          deferredPrompt = null;
        });
      }
    });
  </script>
</body>
</html>
